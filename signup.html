<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SignUP</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <link rel="stylesheet" href="./styles/navbar.css">
  <link rel="stylesheet" href="./styles/footer.css">
  <link rel="stylesheet" href="./styles/signup.css">
  <link rel="stylesheet" href="./styles/login.css">


</head>

<body>
  <section id="header1"> 
  </section>

  <section id="top1">
  </section>

  <section id="signup">
    <div class="signup-container"> <!-- Replace this line -->
      <form id="register_form">
        <h2>Sign up</h2>
        <div class="line"></div>
        <div>
          <label for="">Username</label>
          <input type="text" id="username" placeholder="Enter Username" />
          <label>Email</label>
          <input type="email" id="email" placeholder="Enter Email id" />
          <label>Password</label>
          <input type="password" id="password" placeholder="Enter password" />
          <button type="button" id="register_btn" class="btn">Signup</button>
          <button type="button" id="google_signup_btn" class="btn">
           Signup with Google
          </button>
        </div>
        <div style="margin-top: 10px;">
          <a class="anchor" href="./login.html">Already Account? Please Login</a>
        </div>
      </form>
    </div> <!-- Replace this line -->
  </section>
  
  <footer id="mainFooter">

  </footer>
</body>

</html>


<script type="module">
  import footer1 from "./components/footer.js"
  let footerContainer = document.getElementById('mainFooter');
  footerContainer.innerHTML = footer1();

  import header1 from "./components/header.js"
  let headerContainer = document.getElementById("header1");
  headerContainer.innerHTML = header1();

  import topSection from "./components/top.js"
  let topContainer = document.getElementById("top1");
  topContainer.innerHTML = topSection();

  

</script>


<script src="./script/signup.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-analytics.js"></script>





<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-analytics.js";
  import {
      getAuth,
      createUserWithEmailAndPassword,
      GoogleAuthProvider,
      signInWithPopup
  } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
  import {
      getDatabase,
      ref,
      set,
  } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";

  const firebaseConfig = {
      apiKey: "AIzaSyBhmOoAIMsZyc10v6ljfC8Z-1qzNX0qXFw",
      authDomain: "myproject-58656.firebaseapp.com",
      projectId: "myproject-58656",
      storageBucket: "myproject-58656.appspot.com",
      messagingSenderId: "332827951988",
      appId: "1:332827951988:web:a047ef463eb1afce8ee221",
      measurementId: "G-FP2C2ZGBYC",
  };

  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const database = getDatabase();
  const auth = getAuth();

  document.getElementById("register_btn").addEventListener("click", function (event) {
      event.preventDefault();
      let email = document.getElementById("email").value;
      let password = document.getElementById("password").value;
      let userName = document.getElementById("username").value;

      createUserWithEmailAndPassword(auth, email, password)
          .then((userCredential) => {
              const user = userCredential.user;
              localStorage.setItem("userId", user.uid);
              set(ref(database, "users/" + user.uid), {
                  username: userName,
                  email: email,
              });
              alert("Register Successfully");
          })
          .catch((error) => {
              const errorCode = error.code;
              const errorMessage = error.message;
              console.log(errorMessage);
          });
  });

  const provider = new GoogleAuthProvider();
  document.getElementById("google_signup_btn").addEventListener("click", function () {
      signInWithPopup(auth, provider)
          .then((result) => {
              const user = result.user;
              console.log(user);
          })
          .catch((error) => {
              const errorCode = error.code;
              const errorMessage = error.message;
              console.log(errorMessage);
          });
  });

  import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";

// ... your existing code ...

// Check for auth state changes
onAuthStateChanged(auth, (user) => {
    if (user) {
        // User is signed in.
        const displayNameElement = document.getElementById("displayName");
        displayNameElement.innerText = user.displayName || 'User'; 
        
        // Show and hide relevant links
        document.getElementById("loginLink").style.display = "none";
        document.getElementById("signupLink").style.display = "none";
        document.getElementById("signoutLink").style.display = "block";
    } else {
        // User is signed out.
        const displayNameElement = document.getElementById("displayName");
        displayNameElement.innerText = ''; 
        
        // Show and hide relevant links
        document.getElementById("loginLink").style.display = "block";
        document.getElementById("signupLink").style.display = "block";
        document.getElementById("signoutLink").style.display = "none";
    }
});

// Handle the sign-out
document.getElementById("signoutLink").addEventListener("click", function (event) {
    event.preventDefault();
    signOut(auth).then(() => {
        alert('Signed out successfully.');
    }).catch((error) => {
        console.error("Error signing out: ", error);
    });
});

function onSignIn(googleUser) {
  // Get the user details from the Google User object
  var profile = googleUser.getBasicProfile();
  var username = profile.getName();

  // Update the DOM to display the username and hide the user icon
  document.getElementById('user-details').textContent = username;
  document.getElementById('user-details').style.display = 'inline';
  document.getElementById('user-icon').style.display = 'none';
}




</script>




